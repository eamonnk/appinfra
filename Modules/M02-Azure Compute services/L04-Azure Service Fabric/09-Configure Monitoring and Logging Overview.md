

We'll look at some details about OMS and explore more options for logging and analyzing diagnostics.


### OMS and Azure Service Fabric

![On the OMS desktop, the Service Fabric Overview page displays.](../Linked_Image_Files\3.4.2_OMS_SFA_sln.png)

In Operations Management Suite (OMS). There is a management solution – or plug-in – for OMS that is designed specifically for diagnostics on Service Fabric clusters. This solution is called **Service Fabric Analytics**.

Adding this to your OMS workspace provides you with a dashboard. In one glance, you'll get an overview of important issues, and cluster and application events. These graphs are based on diagnostics data that is gathered from the servers that form the Service Fabric cluster. By using the VM extension Windows Azure Diagnostics, you install an agent on your VMs that is able to collect and upload this diagnostics data into a storage account. OMS can access that data to analyze and present on the dashboard.



![On the OMS desktop, the Log Search page displays.](../Linked_Image_Files\3.4.2_OMS_Log_Analytics_sln.png)

If you want to drill down to the details of the graphs, you can do so by clicking on the items in the table. This will navigate you to the OMS Log Analytics management solution. By using Log Analytics, you can view detailed descriptions of all captured diagnostics data.

You can review details of diagnostics events, such as Event Trace for Windows (ETW), that were generated by Services and Actors running in Service Fabric. ETW is a high-performance logging system. You can use ETW for logging information, such as errors or diagnostics traces from your application.

OMS being used for a lot of our diagnostics so far, but there are alternative tools that you can use.

### Service Fabric diagnostics alternatives

Logging by using an agent process is generally advisable, as it can keep working even if your service does not. This in-process approach works well for custom logs created by services that would otherwise require infrastructure changes to be properly logged. Specifically, all event sources used in code must be registered on every cluster node to work. The recommended way to do this is to register them in your Azure Resource Manager template.

If you don't want to register every event provider in your template, using Microsoft Diagnostics EventFlow for these specific logs might be a good solution. It's fine to use a combination of both methods.

#### EventFlow
EventFlow is an open-source library designed specifically for in-process log collection. The Microsoft Visual Studio Team created the resource. This library enables your services to send logs directly to a central location, while not relying on an agent such as the Azure Diagnostics extension to do that.

This makes sense if services come and go, or when services need to send their data to varying central locations. EventFlow does not rely on the Event Trace for Windows infrastructure; it can send logs to many outputs, including Application Insights, OMS, Azure Event Hubs, and the console window.
